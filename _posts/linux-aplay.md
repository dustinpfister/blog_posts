---
title: Linux aplay command and ALSA
date: 2023-06-15 12:37:00
tags: [linux]
layout: post
categories: linux
id: 1052
updated: 2023-06-15 20:10:37
version: 1.3
---

The [Linux aplay](https://linux.die.net/man/1/aplay) command of [ALSA](https://en.wikipedia.org/wiki/Advanced_Linux_Sound_Architecture) is pretty cool as it can be used as a tool to play any kind of raw data as sound. This data can be [piped](/2020/10/09/linux-pipe/) into the standard input of the aplay command, or a file can be passed as a positional argument. Any kind of data can be used as sample data, but to really start using aplay by one way or another it would be best to fine ways to generate sample data.

<!-- more -->

## Pipe in random data by using cat

Any kind of data can be piped into the standard input of aplay, this includes random data generated by making use of [cat](/2020/11/11/linux-cat/), and dev random. When doing something like this I can use the -d option of aplay to limit the amount of time that this will play to 3 seconds.

```
$ cat /dev/random | aplay -d 3
Playing raw data 'stdin' : Unsigned 8 bit, Rate 8000 Hz, Mono
```

I can set -d option to 0, or just not give any -d option at all sense that is the default which will result in aplay just continuing to play random data as sound until I do a control+c or end the process by whatever means.

## Formats

By default the format that is used is U8 which is unsigned 8 bit audio. There are a number of other formats that often can be used, however the full list of formats will change from one sound card to another. For the most part thus far I have just been sticking to unsigned 8 bit mono audio

```
$ cat /dev/random | aplay -d 5 -f U8
$ cat /dev/random | aplay -d 5 -f S32_LE
```

## Sample Rates

The sample rate can also be adjusted by way of the -r option. The main page says that valid values are 2000 through 192000 Hertz, and the default as we can see is 8000 Hertz. The man page also says that if I give a value less than 300 that will be used as a kilohertz which would be that I should be able to give a value like 41 for for 41000 Hertz.

```
$ cat /dev/random | aplay -d 5 -f U8 -r 2000
$ cat /dev/random | aplay -d 5 -f U8 -r 88000
```

## Using cat and dd to generate 8K bytes of random data for just one second of noise

So far I have been piping in data to aplay by way of using the linux cat command with the use of /dev/random. However another major command I could pipe the random data into would be the [dd command](/2023/06/08/linux-dd/) which has the -bs option that can be used to set, say 8000 bytes blocks, and I can do 60 blocks. This would then result in 60 seconds worth of audio data if it is still 8 Bit Sample Size, and 8000 hertz. However when doing so I will want to make sure that I set the iflag option to fullblock else the resulting file will end up being a bit light because of a partial read error.

```
 $ cat /dev/random | dd bs=8000 count=60 iflag=fullblock > audiodata
60+0 records in
60+0 records out
480000 bytes (480 kB, 469 KiB) copied, 0.0826348 s, 5.8 MB/s
$ aplay -f U8 -r 8000 audiodata
Playing raw data 'audiodata' : Unsigned 8 bit, Rate 8000 Hz, Mono
```

